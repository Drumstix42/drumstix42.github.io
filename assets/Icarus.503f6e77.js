var U=Object.defineProperty,F=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var V=(e,t,a)=>t in e?U(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,w=(e,t)=>{for(var a in t||(t={}))J.call(t,a)&&V(e,a,t[a]);if(O)for(var a of O(t))K.call(t,a)&&V(e,a,t[a]);return e},q=(e,t)=>F(e,G(t));import{I as L,o as r,d as C,e as n,J as Y,K as W,L as $,M as E,r as i,c as d,a as l,w as c,t as y,f as x,O as X,P as M,Q as j,F as N,b as A,T as Z}from"./vendor.cc9c0552.js";import{_ as k}from"./index.4f50c0ed.js";const ee={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 448 512"},te=n("path",{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",fill:"currentColor"},null,-1);var ae=L({name:"Plus",render:function(t,a){return r(),C("svg",ee,[te])}});const ne={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 448 512"},se=n("path",{d:"M176 352h-48V48a16 16 0 0 0-16-16H80a16 16 0 0 0-16 16v304H16c-14.19 0-21.36 17.24-11.29 27.31l80 96a16 16 0 0 0 22.62 0l80-96C197.35 369.26 190.22 352 176 352zm240-64H288a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h56l-61.26 70.45A32 32 0 0 0 272 446.37V464a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-56l61.26-70.45A32 32 0 0 0 432 321.63V304a16 16 0 0 0-16-16zm31.06-85.38l-59.27-160A16 16 0 0 0 372.72 32h-41.44a16 16 0 0 0-15.07 10.62l-59.27 160A16 16 0 0 0 272 224h24.83a16 16 0 0 0 15.23-11.08l4.42-12.92h71l4.41 12.92A16 16 0 0 0 407.16 224H432a16 16 0 0 0 15.06-21.38zM335.61 144L352 96l16.39 48z",fill:"currentColor"},null,-1);var oe=L({name:"SortAlphaDown",render:function(t,a){return r(),C("svg",ne,[se])}});const ie={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 352 512"},ce=n("path",{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28L75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256L9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z",fill:"currentColor"},null,-1);var B=L({name:"Times",render:function(t,a){return r(),C("svg",ie,[ce])}});function le(e,t=500){let a;return(...o)=>{clearTimeout(a),a=setTimeout(()=>{e.apply(this,o)},t)}}Object.freeze({1:"1"});function re(e=[]){const t={};return e.forEach(a=>{const o=a.Name;t[o]={label:o,value:o,inputs:[],sources:[],quantity:1},(a.Inputs||[]).forEach(s=>{t[o].inputs.push({itemName:s.Element.RowName,quantity:s.Count})}),(a.RecipeSets||[]).forEach(s=>{t[o].sources.push(s.RowName)}),(a.Outputs||[]).forEach(s=>{(o===s.Element.RowName||o.includes(s.Element.RowName))&&(t[o].quantity=s.Count)})}),t}const de=()=>Date.now(),P=()=>Y({id:de(),title:"Planning",items:[]}),H=(e,t)=>t.findIndex(a=>a.id===e),Q=P(),ue=Q.id,p=W("icarus",{state:()=>({activeTabId:ue,tabs:[Q],recipeData:{},recipeOptions:[],isLoadingRecipes:!1,recipeSearch:""}),getters:{activeTab:e=>e.tabs.find(t=>t.id===e.activeTabId),tabCount(){return this.tabs.length},sortedRecipeOptions(e){return e.recipeOptions.sort((t,a)=>t.label.localeCompare(a.label))},filteredRecipeOptions(e){if(e.recipeSearch){const t=e.recipeSearch.toLowerCase();return this.sortedRecipeOptions.filter(a=>a.label.toLowerCase().includes(t))}return this.sortedRecipeOptions}},actions:{addTab(){const e=P();return this.tabs.push(e),e},removeTab(e){const t=H(e,this.tabs);if(t!==-1)this.tabs.splice(t,1);else{console.error(`Could not find tab with id ${e}`,this.tabs);return}const a=Math.min(t,this.tabs.length-1),o=this.tabs[a];this.activeTabId=o.id},setActiveTab(e){this.activeTabId=e},setTabTitle(e,t){const a=H(e,this.tabs);a!==-1&&(this.tabs[a].title=t)},addItem(e,t=1){const a=this.activeTab;if(a){const o=a.items.find(s=>s.value===e);o?o.quantity+=t:a.items.push({value:e,quantity:t})}else console.error(`Could not find tab with id ${this.activeTabId}`,this.tabs)},removeItem(e){const t=this.activeTab;if(t){const a=t.items.findIndex(o=>o.value===e);t.items.splice(a,1)}else console.error(`Could not find tab with id ${this.activeTabId}`,this.tabs)},async loadRecipeData(){this.isLoadingRecipes=!0;const t=await(await fetch("/Icarus/Data/Recipes.json",{method:"GET",headers:{"Content-Type":"application/json"}})).json(),a=re(t==null?void 0:t.Rows);console.log(a),this.recipeData=a,this.recipeOptions=Object.values(a),this.isLoadingRecipes=!1}}});const _e=p(),me={name:"CraftingToolItemSelector",components:{Plus:ae},props:{},data(){return{searchValue:null}},computed:w({},$(p,["isLoadingRecipes","filteredRecipeOptions"])),methods:q(w({},E(p,["addItem"])),{onSearch:le(e=>{_e.recipeSearch=e},100)})},pe={class:"mb-3"},he=["onClick"],be={class:"flex-shrink",style:{"min-width":"0"}},ve={class:"label text-overflow-ellipsis"},fe=x(" Add to list ");function ge(e,t,a,o,s,u){const f=i("n-input"),h=i("n-image"),b=i("Plus"),v=i("n-icon"),g=i("n-button"),T=i("n-tooltip"),_=i("RecycleScroller"),R=i("n-card"),m=i("n-spin");return r(),d("div",null,[l("div",pe,[n(f,{type:"text",value:s.searchValue,"onUpdate:value":t[0]||(t[0]=I=>s.searchValue=I),placeholder:"Search...",clearable:"",onInput:u.onSearch},null,8,["value","onInput"])]),n(m,{show:e.isLoadingRecipes},{default:c(()=>[n(R,{class:"scroll-wrap","content-style":"padding: 0;"},{default:c(()=>[n(_,{class:"scroller",items:e.filteredRecipeOptions,"item-size":40,"key-field":"value"},{default:c(({index:I,item:D})=>[l("div",{class:"recipe-item flex align-items-center",onClick:et=>e.addItem(D.value)},[n(h,{class:"icon",width:"32",src:`/Icarus/ItemIcons/ITEM_${D.label}.png`,"fallback-src":"/Icarus/Images/question-mark.png","preview-disabled":!0},null,8,["src"]),l("div",be,[l("div",ve,y(D.label),1)]),n(T,{trigger:"hover"},{trigger:c(()=>[n(g,{class:"hover-button ml-auto",secondary:"",type:"default",size:"small"},{default:c(()=>[n(v,{size:"13"},{default:c(()=>[n(b)]),_:1})]),_:1})]),default:c(()=>[fe]),_:1})],8,he)]),_:1},8,["items"])]),_:1})]),_:1},8,["show"])])}var Te=k(me,[["render",ge],["__scopeId","data-v-26fa051a"]]);const Ie={name:"CraftingToolManageTab",components:{Times:B},props:{tab:{type:Object,required:!0}},emits:["removeTab"],data(){return{}},computed:w({},$(p,["tabs","tabCount"])),methods:{removeTab(){this.$emit("removeTab",{tabId:this.tab.id})}}},we=e=>(M("data-v-42d8af9e"),e=e(),j(),e),ye={class:"manage-tab flex align-items-center"},xe={class:"flex-grow-1 flex align-items-center"},Ce={class:"flex align-items-center"},$e=we(()=>l("span",{class:"flex-shrink-0 mr-3"},"List Name:",-1)),ke=x(" Delete Tab ");function Se(e,t,a,o,s,u){const f=i("n-input"),h=i("Times"),b=i("n-icon"),v=i("n-button"),g=i("n-tooltip");return r(),d("div",ye,[l("div",xe,[l("div",Ce,[$e,n(f,{type:"text",value:a.tab.title,"onUpdate:value":t[0]||(t[0]=T=>a.tab.title=T),placeholder:"Name"},null,8,["value"])])]),e.tabCount>1?(r(),C(g,{key:0,trigger:"hover"},{trigger:c(()=>[n(v,{class:"",secondary:"",type:"error",onClick:u.removeTab},{default:c(()=>[n(b,{size:"20"},{default:c(()=>[n(h)]),_:1})]),_:1},8,["onClick"])]),default:c(()=>[ke]),_:1})):X("",!0)])}var Re=k(Ie,[["render",Se],["__scopeId","data-v-42d8af9e"]]);const De={name:"CraftingToolCalculator",components:{SortAlphaDown:oe,Times:B},props:{tab:{type:Object,required:!0}},data(){return{requiredItemData:{}}},computed:w({},$(p,["recipeData"])),methods:{sortInputs(){this.tab.items.sort((e,t)=>{const a=this.recipeData[e.value].label,o=this.recipeData[t.value].label;return a<o?-1:a>o?1:0})},onQuantityChange(e){e.quantity<1?this.$nextTick(()=>{this.removeItem(e),this.calculateRequiredItems()}):this.$nextTick(()=>{this.calculateRequiredItems()})},validateQuantity(e){return Number.isInteger(e)},removeItem(e){const t=(this.tab.items||[]).findIndex(a=>a.value===e.value);t>-1&&this.tab.items.splice(t,1)},calculateRequiredItems(){const e={};(this.tab.items||[]).forEach(t=>{const a=this.recipeData[t.value],o=t.quantity;(a.inputs||[]).forEach(s=>{e[s.itemName]?e[s.itemName]+=s.quantity*o:e[s.itemName]=s.quantity*o})}),this.requiredItemData=e}}},z=e=>(M("data-v-8fac03e0"),e=e(),j(),e),qe={key:0},Le={class:"flex align-items-center"},Ne=z(()=>l("h3",null,"Items",-1)),Ae=x(" Sort items alphabetically "),ze={class:"flex-shrink",style:{"min-width":"0"}},Oe={class:"label text-overflow-ellipsis"},Ve=x(" Remove from list "),Ee=z(()=>l("div",{class:"flex align-items-center mt-3"},[l("h3",null,"Required Components")],-1)),Me={key:1,class:"mb-3"},je=z(()=>l("h3",null,"No Items",-1)),Be=x("You haven't added any items to this list yet.");function Pe(e,t,a,o,s,u){const f=i("SortAlphaDown"),h=i("n-icon"),b=i("n-button"),v=i("n-tooltip"),g=i("n-input-number"),T=i("n-image"),_=i("Times"),R=i("n-text");return r(),d("div",null,[a.tab.items.length>0?(r(),d("div",qe,[l("div",Le,[Ne,n(v,{trigger:"hover"},{trigger:c(()=>[n(b,{class:"ml-3",size:"tiny",secondary:"",circle:"",type:"default",onClick:u.sortInputs},{default:c(()=>[n(h,{size:"13"},{default:c(()=>[n(f)]),_:1})]),_:1},8,["onClick"])]),default:c(()=>[Ae]),_:1})]),n(Z,{"x-appear":"",name:"list",tag:"div"},{default:c(()=>[(r(!0),d(N,null,A(a.tab.items,m=>(r(),d("div",{class:"recipe-item flex align-items-center",key:m.value},[n(g,{class:"input-quantity flex-shrink-0",value:m.quantity,"onUpdate:value":I=>m.quantity=I,placeholder:"Quantity",min:0,validator:u.validateQuantity,"on-update-value":u.onQuantityChange(m)},null,8,["value","onUpdate:value","validator","on-update-value"]),n(T,{class:"icon",width:"32",src:`/Icarus/ItemIcons/ITEM_${e.recipeData[m.value].label}.png`,"fallback-src":"/Icarus/Images/question-mark.png","preview-disabled":!1},null,8,["src"]),l("div",ze,[l("div",Oe,y(e.recipeData[m.value].label),1)]),n(v,{trigger:"hover"},{trigger:c(()=>[n(b,{class:"hover-button ml-auto",secondary:"",type:"error",size:"small",onClick:I=>u.removeItem(m)},{default:c(()=>[n(h,{size:"13"},{default:c(()=>[n(_)]),_:1})]),_:2},1032,["onClick"])]),default:c(()=>[Ve]),_:2},1024)]))),128))]),_:1}),Ee,l("div",null,[(r(!0),d(N,null,A(s.requiredItemData,(m,I)=>(r(),d("div",null,y(m)+" "+y(I),1))),256))])])):(r(),d("div",Me,[je,n(R,{type:"info"},{default:c(()=>[Be]),_:1})]))])}var He=k(De,[["render",Pe],["__scopeId","data-v-8fac03e0"]]);const S=p(),Qe={name:"CraftingToolTabView",components:{ManageTab:Re,CraftingCalculator:He},props:[],data(){return{activeTabId:S.activeTabId,maxTabCount:20,addable:!0,closable:!0}},watch:{activeTabId:function(e){this.setActiveTab(e)}},computed:w({},$(p,["tabs","tabCount","activeTab"])),methods:q(w({},E(p,["setActiveTab"])),{handleAdd(){},handleClose(){},addTab(){const e=S.addTab();this.setActiveTab(e.id),this.syncSelectedTab()},removeTab({tabId:e}={}){S.removeTab(e),this.syncSelectedTab()},syncSelectedTab(){this.activeTabId=S.activeTabId,this.$nextTick(()=>{var e;(e=this.$refs.tabsInstRef)==null||e.syncBarPosition()})}})},Ue={class:"flex align-items-center mb-3"},Fe={class:"flex align-items-center ml-auto"},Ge={class:"mr-3"},Je=l("span",null,"Add Tab",-1);function Ke(e,t,a,o,s,u){const f=i("n-button"),h=i("manage-tab"),b=i("crafting-calculator"),v=i("n-tab-pane"),g=i("n-tabs"),T=i("n-card");return r(),d("div",null,[l("div",Ue,[l("div",Fe,[l("div",Ge,y(e.tabCount)+" / "+y(s.maxTabCount),1),n(f,{class:"",strong:"",secondary:"",type:"primary",onClick:u.addTab,disabled:e.tabCount===s.maxTabCount},{default:c(()=>[Je]),_:1},8,["onClick","disabled"])])]),n(T,null,{default:c(()=>[n(g,{ref:"tabsInstRef",value:s.activeTabId,"onUpdate:value":t[0]||(t[0]=_=>s.activeTabId=_),type:"bar",addable:s.addable,closable:s.closable,"tab-style":""},{default:c(()=>[(r(!0),d(N,null,A(e.tabs,_=>(r(),C(v,{tab:_.title,name:_.id,key:_.id},{default:c(()=>[n(h,{tab:_,onRemoveTab:u.removeTab},null,8,["tab","onRemoveTab"]),n(b,{tab:_},null,8,["tab"])]),_:2},1032,["tab","name"]))),128))]),_:1},8,["value","addable","closable"])]),_:1})])}var Ye=k(Qe,[["render",Ke]]);const We={class:"icarus-wrap"},Xe=x(" Search and add items from the list below to add them to your to-do list, which will calculate your item requirements. "),Ze={class:"flex flex-wrap"},st={setup(e){return p().loadRecipeData(),(a,o)=>{const s=i("n-alert");return r(),d("div",We,[n(s,{class:"m-2 mb-4",title:"Crafting Calculator",type:"info",closable:""},{default:c(()=>[Xe]),_:1}),l("div",Ze,[n(Te,{class:"item-selector"}),n(Ye,{class:"tab-view flex-1"})])])}}};export{st as default};
