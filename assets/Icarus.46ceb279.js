var G=Object.defineProperty,Y=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var V=(e,t,n)=>t in e?G(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,y=(e,t)=>{for(var n in t||(t={}))K.call(t,n)&&V(e,n,t[n]);if(E)for(var n of E(t))W.call(t,n)&&V(e,n,t[n]);return e},N=(e,t)=>Y(e,J(t));import{L as O,o as l,d as C,e as a,M as X,O as Z,P as S,Q as P,r as o,c as _,a as c,w as r,t as g,f as x,R as M,S as j,T as B,b as k,F as $,U as ee,V as te}from"./vendor.bc05a8e9.js";import{_ as R}from"./index.a0b30dbb.js";const ne={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 448 512"},ae=a("path",{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",fill:"currentColor"},null,-1);var se=O({name:"Plus",render:function(t,n){return l(),C("svg",ne,[ae])}});const oe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 448 512"},ie=a("path",{d:"M176 352h-48V48a16 16 0 0 0-16-16H80a16 16 0 0 0-16 16v304H16c-14.19 0-21.36 17.24-11.29 27.31l80 96a16 16 0 0 0 22.62 0l80-96C197.35 369.26 190.22 352 176 352zm240-64H288a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h56l-61.26 70.45A32 32 0 0 0 272 446.37V464a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-56l61.26-70.45A32 32 0 0 0 432 321.63V304a16 16 0 0 0-16-16zm31.06-85.38l-59.27-160A16 16 0 0 0 372.72 32h-41.44a16 16 0 0 0-15.07 10.62l-59.27 160A16 16 0 0 0 272 224h24.83a16 16 0 0 0 15.23-11.08l4.42-12.92h71l4.41 12.92A16 16 0 0 0 407.16 224H432a16 16 0 0 0 15.06-21.38zM335.61 144L352 96l16.39 48z",fill:"currentColor"},null,-1);var ce=O({name:"SortAlphaDown",render:function(t,n){return l(),C("svg",oe,[ie])}});const re={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 352 512"},le=a("path",{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28L75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256L9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z",fill:"currentColor"},null,-1);var U=O({name:"Times",render:function(t,n){return l(),C("svg",re,[le])}});function de(e,t=500){let n;return(...s)=>{clearTimeout(n),n=setTimeout(()=>{e.apply(this,s)},t)}}Object.freeze({1:"1"});function ue(e=[]){const t={};return e.forEach(n=>{const s=n.Name;t[s]={label:s,value:s,inputs:[],sources:[],preferredSource:null,quantity:1},(n.Inputs||[]).forEach(i=>{t[s].inputs.push({itemName:i.Element.RowName,quantity:i.Count})}),(n.RecipeSets||[]).forEach(i=>{t[s].sources.push(i.RowName)}),t[s].preferredSource=t[s].sources[0],(n.Outputs||[]).forEach(i=>{(s===i.Element.RowName||s.includes(i.Element.RowName))&&(t[s].quantity=i.Count)})}),t}const _e=()=>Date.now(),H=()=>X({id:_e(),title:"Planning",items:[]}),Q=(e,t)=>t.findIndex(n=>n.id===e),F=H(),pe=F.id,b=Z("icarus",{state:()=>({activeTabId:pe,tabs:[F],recipeData:{},recipeOptions:[],isLoadingRecipes:!1,recipeSearch:""}),getters:{activeTab:e=>e.tabs.find(t=>t.id===e.activeTabId),tabCount(){return this.tabs.length},sortedRecipeOptions(e){return e.recipeOptions.sort((t,n)=>t.label.localeCompare(n.label))},filteredRecipeOptions(e){if(e.recipeSearch){const t=e.recipeSearch.toLowerCase();return this.sortedRecipeOptions.filter(n=>n.label.toLowerCase().includes(t))}return this.sortedRecipeOptions}},actions:{addTab(){const e=H();return this.tabs.push(e),e},removeTab(e){const t=Q(e,this.tabs);if(t!==-1)this.tabs.splice(t,1);else{console.error(`Could not find tab with id ${e}`,this.tabs);return}const n=Math.min(t,this.tabs.length-1),s=this.tabs[n];this.activeTabId=s.id},setActiveTab(e){this.activeTabId=e},setTabTitle(e,t){const n=Q(e,this.tabs);n!==-1&&(this.tabs[n].title=t)},addItem(e,t=1){const n=this.activeTab;if(n){const s=n.items.find(i=>i.value===e);s?s.quantity+=t:n.items.push({value:e,quantity:t})}else console.error(`Could not find tab with id ${this.activeTabId}`,this.tabs)},removeItem(e){const t=this.activeTab;if(t){const n=t.items.findIndex(s=>s.value===e);t.items.splice(n,1)}else console.error(`Could not find tab with id ${this.activeTabId}`,this.tabs)},async loadRecipeData(){this.isLoadingRecipes=!0;const t=await(await fetch("/Icarus/Data/Recipes.json",{method:"GET",headers:{"Content-Type":"application/json"}})).json(),n=ue(t==null?void 0:t.Rows);console.log(n),this.recipeData=n,this.recipeOptions=Object.values(n),this.isLoadingRecipes=!1}}});const me=b(),he={name:"CraftingToolItemSelector",components:{Plus:se},props:{},data(){return{searchValue:null}},computed:y({},S(b,["isLoadingRecipes","filteredRecipeOptions"])),methods:N(y({},P(b,["addItem"])),{onSearch:de(e=>{me.recipeSearch=e},100)})},be={class:"mb-3"},ve=["onClick"],fe={class:"flex-shrink",style:{"min-width":"0"}},ge={class:"label text-overflow-ellipsis"},Te=x(" Add to list ");function Ie(e,t,n,s,i,d){const v=o("n-input"),h=o("n-image"),p=o("Plus"),f=o("n-icon"),T=o("n-button"),I=o("n-tooltip"),m=o("RecycleScroller"),z=o("n-card"),A=o("n-spin");return l(),_("div",null,[c("div",be,[a(v,{type:"text",value:i.searchValue,"onUpdate:value":t[0]||(t[0]=q=>i.searchValue=q),placeholder:"Search...",clearable:"",onInput:d.onSearch},null,8,["value","onInput"])]),a(A,{show:e.isLoadingRecipes},{default:r(()=>[a(z,{class:"scroll-wrap","content-style":"padding: 0;"},{default:r(()=>[a(m,{class:"scroller",items:e.filteredRecipeOptions,"item-size":40,"key-field":"value"},{default:r(({index:q,item:u})=>[c("div",{class:"recipe-item flex align-items-center",onClick:w=>e.addItem(u.value)},[a(h,{class:"icon",width:"32",src:`/Icarus/ItemIcons/ITEM_${u.value}.png`,"fallback-src":"/Icarus/Images/question-mark.png","preview-disabled":!0},null,8,["src"]),c("div",fe,[c("div",ge,g(u.label),1)]),a(I,{trigger:"hover"},{trigger:r(()=>[a(T,{class:"hover-button ml-auto",secondary:"",type:"default",size:"small"},{default:r(()=>[a(f,{size:"13"},{default:r(()=>[a(p)]),_:1})]),_:1})]),default:r(()=>[Te]),_:1})],8,ve)]),_:1},8,["items"])]),_:1})]),_:1},8,["show"])])}var we=R(he,[["render",Ie],["__scopeId","data-v-a0479206"]]);const ye={name:"CraftingToolManageTab",components:{Times:U},props:{tab:{type:Object,required:!0}},emits:["removeTab"],data(){return{}},computed:y({},S(b,["tabs","tabCount"])),methods:{removeTab(){this.$emit("removeTab",{tabId:this.tab.id})}}},Ce=e=>(j("data-v-42d8af9e"),e=e(),B(),e),xe={class:"manage-tab flex align-items-center"},Se={class:"flex-grow-1 flex align-items-center"},ke={class:"flex align-items-center"},$e=Ce(()=>c("span",{class:"flex-shrink-0 mr-3"},"List Name:",-1)),Re=x(" Delete Tab ");function De(e,t,n,s,i,d){const v=o("n-input"),h=o("Times"),p=o("n-icon"),f=o("n-button"),T=o("n-tooltip");return l(),_("div",xe,[c("div",Se,[c("div",ke,[$e,a(v,{type:"text",value:n.tab.title,"onUpdate:value":t[0]||(t[0]=I=>n.tab.title=I),placeholder:"Name"},null,8,["value"])])]),e.tabCount>1?(l(),C(T,{key:0,trigger:"hover"},{trigger:r(()=>[a(f,{class:"",secondary:"",type:"error",onClick:d.removeTab},{default:r(()=>[a(p,{size:"20"},{default:r(()=>[a(h)]),_:1})]),_:1},8,["onClick"])]),default:r(()=>[Re]),_:1})):M("",!0)])}var qe=R(ye,[["render",De],["__scopeId","data-v-42d8af9e"]]);const Le={name:"CraftingToolComponentSourcePicker",components:{},props:{componentName:{type:String,required:!0}},data(){return{}},computed:y({},S(b,["recipeData"])),methods:{setComponentPreferredSource(e,t){this.recipeData[e].preferredSource=t,this.$emit("update")}}},ze={key:0},Ae={key:1};function Ne(e,t,n,s,i,d){const v=o("n-button"),h=o("n-button-group");return e.recipeData[n.componentName]?(l(),C(h,{key:0,size:"small"},{default:r(()=>[(l(!0),_($,null,k(e.recipeData[n.componentName].sources,(p,f)=>(l(),C(v,{key:p,class:"mx-1",size:"tiny",ghost:"",round:"",type:"info",style:ee([e.recipeData[n.componentName].preferredSource===p?null:"--n-border: 1px solid rgba(255, 255, 255, 0.2); --n-text-color: #bbb"]),onClick:T=>d.setComponentPreferredSource(n.componentName,p)},{default:r(()=>[e.recipeData[p]?(l(),_("span",ze,g(e.recipeData[p].label),1)):(l(),_("span",Ae,g(p),1))]),_:2},1032,["style","onClick"]))),128))]),_:1})):M("",!0)}var Oe=R(Le,[["render",Ne]]);const Ee={name:"CraftingToolCalculator",components:{ComponentSourcePicker:Oe,SortAlphaDown:ce,Times:U},props:{tab:{type:Object,required:!0}},data(){return{requiredItemData:{},requiredCraftingStations:[],showSubComponents:!0}},computed:y({},S(b,["recipeData"])),methods:{sortInputs(){this.tab.items.sort((e,t)=>{const n=this.recipeData[e.value].label,s=this.recipeData[t.value].label;return n<s?-1:n>s?1:0})},onQuantityChange(e){e.quantity<1?this.$nextTick(()=>{this.removeItem(e),this.calculateRequiredItems()}):this.$nextTick(()=>{this.calculateRequiredItems()})},validateQuantity(e){return Number.isInteger(e)},removeItem(e){const t=(this.tab.items||[]).findIndex(n=>n.value===e.value);t>-1&&this.tab.items.splice(t,1)},calculateRequiredItems(){const e={},t=new Set([]);(this.tab.items||[]).forEach(n=>{const s=this.recipeData[n.value],i=n.quantity;(s.inputs||[]).forEach(d=>{e[d.itemName]?e[d.itemName]+=d.quantity*i:e[d.itemName]=d.quantity*i})}),Object.keys(e).forEach(n=>{const s=this.recipeData[n];(s==null?void 0:s.preferredSource)&&t.add(s.preferredSource)}),this.requiredCraftingStations=[...t],this.requiredItemData=e},setComponentPreferredSource(e,t){this.recipeData[e].preferredSource=t,this.calculateRequiredItems()}}},D=e=>(j("data-v-4f61de5c"),e=e(),B(),e),Ve={key:0},Pe={class:"flex align-items-center"},Me=D(()=>c("h3",null,"Items",-1)),je=x(" Sort items alphabetically "),Be={class:"flex-shrink",style:{"min-width":"0"}},Ue={class:"label text-overflow-ellipsis"},He=x(" Remove from list "),Qe=D(()=>c("div",{class:"flex align-items-center mt-3"},[c("h3",null,"Components")],-1)),Fe={class:"p-1"},Ge={class:"flex align-items-center mb-3"},Ye=D(()=>c("span",null,"Show sub-components",-1)),Je={class:"label"},Ke=D(()=>c("div",{class:"flex align-items-center"},[c("h3",null,"Crafting Stations")],-1)),We={class:""},Xe={class:"recipe-item pl-0 flex align-items-center"},Ze={class:"flex align-items-center"},et={class:"label"},tt={key:1,class:"mb-3"},nt=D(()=>c("h3",null,"No Items",-1)),at=x("You haven't added any items to this list yet.");function st(e,t,n,s,i,d){const v=o("SortAlphaDown"),h=o("n-icon"),p=o("n-button"),f=o("n-tooltip"),T=o("n-input-number"),I=o("n-image"),m=o("component-source-picker"),z=o("Times"),A=o("n-switch"),q=o("n-text");return l(),_("div",null,[n.tab.items.length>0?(l(),_("div",Ve,[c("div",Pe,[Me,a(f,{trigger:"hover"},{trigger:r(()=>[a(p,{class:"ml-3",size:"tiny",secondary:"",circle:"",type:"default",onClick:d.sortInputs},{default:r(()=>[a(h,{size:"13"},{default:r(()=>[a(v)]),_:1})]),_:1},8,["onClick"])]),default:r(()=>[je]),_:1})]),a(te,{"x-appear":"",name:"list",tag:"div"},{default:r(()=>[(l(!0),_($,null,k(n.tab.items,u=>(l(),_("div",{class:"recipe-item flex align-items-center",key:u.value},[a(T,{class:"input-quantity flex-shrink-0",value:u.quantity,"onUpdate:value":w=>u.quantity=w,placeholder:"Quantity",min:0,validator:d.validateQuantity,"on-update-value":d.onQuantityChange(u)},null,8,["value","onUpdate:value","validator","on-update-value"]),a(I,{class:"icon",width:"32",src:`/Icarus/ItemIcons/ITEM_${e.recipeData[u.value].value}.png`,"fallback-src":"/Icarus/Images/question-mark.png","preview-disabled":!1},null,8,["src"]),c("div",Be,[c("div",Ue,g(e.recipeData[u.value].label),1)]),a(m,{"component-name":u.value,onChange:t[0]||(t[0]=w=>d.calculateRequiredItems())},null,8,["component-name"]),a(f,{trigger:"hover"},{trigger:r(()=>[a(p,{class:"hover-button ml-auto",secondary:"",type:"error",size:"small",onClick:w=>d.removeItem(u)},{default:r(()=>[a(h,{size:"13"},{default:r(()=>[a(z)]),_:1})]),_:2},1032,["onClick"])]),default:r(()=>[He]),_:2},1024)]))),128))]),_:1}),Qe,c("div",Fe,[c("div",Ge,[a(A,{class:"mr-2",value:i.showSubComponents,"onUpdate:value":t[1]||(t[1]=u=>i.showSubComponents=u),size:"small"},null,8,["value"]),Ye]),c("div",null,[(l(!0),_($,null,k(i.requiredItemData,(u,w)=>(l(),_("div",{key:w,class:"component-row flex align-items-center"},[c("div",Je,g(u)+" "+g(w),1),a(m,{"component-name":w,onChange:t[2]||(t[2]=bt=>d.calculateRequiredItems())},null,8,["component-name"])]))),128))])]),Ke,c("div",We,[(l(!0),_($,null,k(i.requiredCraftingStations,u=>(l(),_("div",Xe,[c("div",Ze,[a(I,{class:"icon",width:"32",src:`/Icarus/ItemIcons/ITEM_${e.recipeData[u].value}.png`,"fallback-src":"/Icarus/Images/question-mark.png","preview-disabled":!1},null,8,["src"]),c("div",et,g(u),1)])]))),256))])])):(l(),_("div",tt,[nt,a(q,{type:"info"},{default:r(()=>[at]),_:1})]))])}var ot=R(Ee,[["render",st],["__scopeId","data-v-4f61de5c"]]);const L=b(),it={name:"CraftingToolTabView",components:{ManageTab:qe,CraftingCalculator:ot},props:[],data(){return{activeTabId:L.activeTabId,maxTabCount:20,addable:!0,closable:!0}},watch:{activeTabId:function(e){this.setActiveTab(e)}},computed:y({},S(b,["tabs","tabCount","activeTab"])),methods:N(y({},P(b,["setActiveTab"])),{handleAdd(){},handleClose(){},addTab(){const e=L.addTab();this.setActiveTab(e.id),this.syncSelectedTab()},removeTab({tabId:e}={}){L.removeTab(e),this.syncSelectedTab()},syncSelectedTab(){this.activeTabId=L.activeTabId,this.$nextTick(()=>{var e;(e=this.$refs.tabsInstRef)==null||e.syncBarPosition()})}})},ct={class:"flex align-items-center mb-3"},rt={class:"flex align-items-center ml-auto"},lt={class:"mr-3"},dt=c("span",null,"Add Tab",-1);function ut(e,t,n,s,i,d){const v=o("n-button"),h=o("manage-tab"),p=o("crafting-calculator"),f=o("n-tab-pane"),T=o("n-tabs"),I=o("n-card");return l(),_("div",null,[c("div",ct,[c("div",rt,[c("div",lt,g(e.tabCount)+" / "+g(i.maxTabCount),1),a(v,{class:"",strong:"",secondary:"",type:"primary",onClick:d.addTab,disabled:e.tabCount===i.maxTabCount},{default:r(()=>[dt]),_:1},8,["onClick","disabled"])])]),a(I,null,{default:r(()=>[a(T,{ref:"tabsInstRef",value:i.activeTabId,"onUpdate:value":t[0]||(t[0]=m=>i.activeTabId=m),type:"bar",addable:i.addable,closable:i.closable,"tab-style":""},{default:r(()=>[(l(!0),_($,null,k(e.tabs,m=>(l(),C(f,{tab:m.title,name:m.id,key:m.id},{default:r(()=>[a(h,{tab:m,onRemoveTab:d.removeTab},null,8,["tab","onRemoveTab"]),a(p,{tab:m},null,8,["tab"])]),_:2},1032,["tab","name"]))),128))]),_:1},8,["value","addable","closable"])]),_:1})])}var _t=R(it,[["render",ut]]);const pt={class:"icarus-wrap"},mt=x(" Search and add items from the list below to add them to your to-do list, which will calculate your item requirements. "),ht={class:"flex flex-wrap"},Tt={setup(e){return b().loadRecipeData(),(n,s)=>{const i=o("n-alert");return l(),_("div",pt,[a(i,{class:"m-2 mb-4",title:"Crafting Calculator",type:"info",closable:""},{default:r(()=>[mt]),_:1}),c("div",ht,[a(we,{class:"item-selector"}),a(_t,{class:"tab-view flex-1"})])])}}};export{Tt as default};
